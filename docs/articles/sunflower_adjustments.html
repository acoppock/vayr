<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sunflower adjustments to avoid overplotting â€¢ vayr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sunflower adjustments to avoid overplotting">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vayr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/sunflower_adjustments.html">Sunflower adjustments to avoid overplotting</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sunflower adjustments to avoid overplotting</h1>
            
      

      <div class="d-none name"><code>sunflower_adjustments.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://alexandercoppock.com" class="external-link">vayr</a></span><span class="op">)</span></span></code></pre></div>
<!-- Let's be sure to credit Maia Cook for the first draft! -->
<!-- ```{r echo=FALSE, warning=FALSE} -->
<!-- # Show original visualization in Persuasion in Parallel (without showing code, just show output) -->
<!-- patriot_act_stacked <- readRDS("/Users/maiacook/Documents/PLSC_349_2024/Final Project/patriot_act_stacked.rds") -->
<!-- gg_df <- -->
<!--   patriot_act_stacked |> -->
<!--   filter(T1_content != "Both", pid_3 != "Independent") |> -->
<!--   mutate( -->
<!--     Y = PA_support, -->
<!--     T1_content = fct_drop(T1_content), -->
<!--     sample_label = factor( -->
<!--       sample, -->
<!--       levels = c("original", "mt"), -->
<!--       labels = c("Original Study", "Mechanical Turk Replication") -->
<!--     ) -->
<!--   ) -->
<!-- gg_df <- -->
<!--   gg_df |> -->
<!--   group_by(pid_3, T1_content, sample_label, Y) |> -->
<!--   mutate( -->
<!--     # sunflower -->
<!--     y_s = sunflower(y = Y, width = 0.12, height = 0.18), -->
<!--     x_s = sunflower(x = as.numeric(T1_content), width = 0.12, height = 0.18), -->
<!--     # dodge -->
<!--     x_s = if_else(pid_3 == "Democrat", x_s - (1 / 8), x_s + (1 / 8)), -->
<!--     # plot letter -->
<!--     plot_letter = case_when(pid_3 == "Democrat" ~ "D", -->
<!--                             pid_3 == "Republican" ~ "R")) -->
<!-- summary_df <- -->
<!--   gg_df |> -->
<!--   group_by(pid_3, T1_content, sample_label) |> -->
<!--   do(tidy(lm_robust(Y ~ 1, weights = weights, data = .))) |> -->
<!--   mutate(Y = estimate) -->
<!-- label_df <- -->
<!--   summary_df |> -->
<!--   filter(T1_content == "Control", -->
<!--          sample_label == "Original Study") |> -->
<!--   ungroup() |> -->
<!--   mutate(Y = c(3.25, 6), -->
<!--          label = c("Democrats", "Republicans")) -->
<!-- figure_5.4 <- -->
<!--   ggplot(summary_df, aes(T1_content, Y, group = pid_3, -->
<!--                          shape = pid_3)) + -->
<!--   geom_point(size = 2, position = position_dodge(width = 0.5)) + -->
<!--   geom_line(position = position_dodge(width = 0.5)) + -->
<!--   geom_errorbar( -->
<!--     aes(ymin = conf.low, ymax = conf.high), -->
<!--     position = position_dodge(width = 0.5), -->
<!--     width = 0 -->
<!--   ) + -->
<!--   geom_text( -->
<!--     data = gg_df, -->
<!--     aes(x = x_s, y = y_s, label = plot_letter, color = 3), -->
<!--     alpha = 0.2, -->
<!--     family = "Palatino", -->
<!--     size = 1 -->
<!--   ) + -->
<!--   scale_y_continuous(breaks = 1:7) + -->
<!--   geom_text( -->
<!--     data = label_df, -->
<!--     aes(label = label), -->
<!--     position = position_dodge(width = 0.5), -->
<!--     size = 2, -->
<!--     family = "Palatino" -->
<!--   ) + -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     text = element_text(family = "Palatino"), -->
<!--     legend.position = "none", -->
<!--     legend.title = element_blank(), -->
<!--     axis.title.x = element_blank(), -->
<!--     axis.title.y = element_text(size = 8), -->
<!--     panel.grid.minor = element_blank(), -->
<!--     strip.background = element_blank() -->
<!--   ) + -->
<!--   ylab( -->
<!--     "Do you oppose or support the Patriot Act? -->
<!--     [1: Oppose very strongly to 7: Support very strongly]" -->
<!--   ) + -->
<!--   facet_wrap( ~ sample_label, scales = "free") -->
<!-- figure_5.4 -->
<!-- ``` -->
<!-- The Patriot Act survey is an excellent example of a dataset with two categorical variables, more than two factor levels, and many observations. These characteristics make it a good candidate for the sunflower position adjustment! Dr. Coppock achieved this position adjustment manually for his figure in Persuasion in Parallel. -->
<!-- However, the goal is to use the sunflower circle packing algorithm and ggproto to create a new position adjustment that will automatically visualize this data the way it is above. Note: the text, font, and color parameters will not be modified to look like the original visualization. -->
<!-- <div style="margin-bottom: 30px;"></div> -->
<!-- #### **Example of `sunflow_jitter()` using the Patriot Act dataset** -->
<!-- ```{r warning=FALSE} -->
<!-- df <- readRDS("/Users/maiacook/Documents/PLSC_349_2024/Final Project/patriot_act_stacked.rds") -->
<!-- df <- df %>% filter(T1_content %in% c("Con", "Control", "Pro")) %>% droplevels() -->
<!-- df <- df %>% filter(pid_3 != "Independent") %>% droplevels() -->
<!-- ggplot(df, aes(x = T1_content, y = PA_support)) + -->
<!--   geom_point(size = 1, position = sunflower_jitter(flower_width = 0.2, flower_height = 0.5)) + theme_minimal() + -->
<!--   labs(title = "Support for the Patriot Act per Experimental Groups", -->
<!--        x = "Experimental Group", -->
<!--        y = "Support for Patriot Act [1 is low, 7 is high]") -->
<!-- ``` -->
<!-- <div style="margin-bottom: 30px;"></div> -->
<!-- #### **Example of `sunflow_jitterdodge()` using the Patriot Act dataset** -->
<!-- ```{r echo=TRUE, warning=FALSE} -->
<!-- summary_data <- df %>% -->
<!--   group_by(T1_content, pid_3) %>% -->
<!--   summarise(avg_support = mean(PA_support, na.rm = TRUE), .groups = "drop") -->
<!-- ggplot(df, aes(T1_content, PA_support, color = pid_3, shape = pid_3)) + -->
<!--   geom_point(position = sunflower_jitterdodge(width = .5, flower_width = 0.1, flower_height = 0.3)) +  -->
<!--   theme_minimal() + -->
<!--   labs(title = "Support for the Patriot Act per Experimental Groups, grouped by Party", -->
<!--        x = "Experimental Group", -->
<!--        y = "Support for Patriot Act [1 is low, 7 is high]") + -->
<!--   geom_text(data = summary_data, aes(x = T1_content, y = avg_support, label = round(avg_support, 2)), -->
<!--             color = "black", vjust = -1, size = 3) + -->
<!--   geom_line(data = summary_data, aes(x = T1_content, y = avg_support, group = pid_3, color = pid_3),  -->
<!--             size = 1) +   -->
<!--   geom_point(data = summary_data, aes(x = T1_content, y = avg_support, shape = pid_3),  -->
<!--              color = "black", size = 4) +   -->
<!--   scale_shape_manual(values = c(16, 17, 18))   -->
<!-- ``` -->
<!-- <div style="margin-bottom: 30px;"></div> -->
<!-- ## When is the sunflower position adjustment not appropriate for a dataset? -->
<!-- The sunflower position adjustment works best for categorical data plotted against categorical data. It is not possible to use this function on continuous vs continuous data. Moreover, it is discouraged from being used on categorical vs. continuous data because the uniform sunflower distribution conceals necessary data about the range and distribution of the continuous variable, removing an essential dimension of information from the visualization. -->
<!-- Below are examples of where the sunflower position adjustment (jitter and jitter dodge) should not be used. These examples use data from a dataset from R's NHANES library. I made minor adjustments to the data to make these visualizations more compelling, which is included in the code below. -->
<!-- #### **Continuous vs Continuous Data: height vs weight** -->
<!-- Using the sunflower position adjustment would not be appropriate for the example below. It would not be the solution to making the points on the plot less dense. Instead, you can set alpha = 0.5 to make the points transparent, helping illustrate areas of high density. A sunflower position adjustment is appropriate when it does not matter how points are distributed. In this case, the location of each point conveys information about both continuous variables. -->
<!-- ```{r echo=TRUE, warning=FALSE} -->
<!-- data("NHANES") -->
<!-- ggplot(NHANES, aes(x= Height, y= Weight, group = Gender, color = Gender)) +  -->
<!--   geom_point(alpha = 0.5) + theme_minimal() -->
<!-- ``` -->
<!-- #### Continuous vs Categorical Data*: height vs age group* -->
<!-- Although the sunflower position adjustment could technically be used for continuous vs categorical data, it would look disastrous. Plus, there are much better ways of visualizing this type of data. In the example below, we look at a height vs. age plot grouped by gender. The beeswarm geom helps us visualize this data in such a way that the distribution of the heights per age group is preserved in translation. Using a uniform circle packing algorithm to showcase a variable that is a continuous range or scale is antithetical to the point of there being a non-random distribution. -->
<!-- ```{r echo=TRUE, warning=FALSE} -->
<!-- library(ggbeeswarm) -->
<!-- data("NHANES") -->
<!-- NHANES <- NHANES %>% filter(!is.na(Height)) -->
<!-- NHANES <- NHANES %>% filter(!is.na(AgeDecade)) -->
<!-- ggplot(NHANES, aes(x = Height, y = AgeDecade, group = Gender, color = Gender)) +  -->
<!--   geom_beeswarm(size = .4, height = 4) +   -->
<!--   labs(title = "Height vs. Age, Grouped by Gender", x = "Height", y = "Age", color = "Gender") + -->
<!--   theme(axis.text.x = element_text(angle = 45, hjust = 1),  -->
<!--         legend.position = "bottom") + -->
<!--   theme_minimal() -->
<!-- ``` -->
<!-- ## Further Directions -->
<!-- The `sunflower_jitter()` and `sunflower_jitterdodge()` position adjustments could be improved by making the radius of each sunflower cluster self-adjusting. Sunflower clusters with less observations should have smaller radii to increase the density of the sunflower. In practice, this would look like the PA example above but with sunflowers of different sizes. I've made multiple attempts at creating this both on my own and with chatGPT, but have been unsuccessful. I hope to continue working on this position adjustment with Professor Coppock and look forward to using other nature-inspired circle packing algorithms on different classes of data. -->
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Coppock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
